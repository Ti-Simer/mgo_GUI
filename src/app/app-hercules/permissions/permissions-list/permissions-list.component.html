
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<body class="min-h-screen bg-gray-50 pb-12">
  <div class="w-full max-w-7xl mx-auto px-4 py-8">
    <!-- Encabezado principal con gradiente -->
    <div class="bg-gradient-to-r from-sky-800 to-sky-900 rounded-2xl p-6 mb-8 shadow-lg">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="flex items-center mb-4 md:mb-0">
          <div class="bg-white/20 text-white p-4 rounded-xl mr-4">
            <lucide-icon name="listTodo" [size]="50"></lucide-icon>
          </div>
          <div>
            <h1 class="text-2xl md:text-3xl font-bold text-white">{{'Administración de Permisos' | translate}}</h1>
            <p class="text-sky-200 mt-1">{{'Gestión centralizada de permisos de la aplicación' | translate}}</p>
          </div>
        </div>
        <div class="flex items-center space-x-4">
        </div>
      </div>
      <div class="h-1 w-24 bg-sky-400 rounded-full mt-4"></div>
    </div>

    <!-- Panel Principal -->
    <div class="min-h-[40vh] grid grid-cols-1 lg:grid-cols-4 gap-4 py-3">
      <!-- Sección principal de permisos -->
      <div class="w-full bg-gray-100/50 rounded-2xl p-6 shadow-md lg:col-span-4">
        <!-- Encabezado con gradiente -->
        <div class="bg-gradient-to-r from-sky-800 to-sky-900 rounded-xl p-5 mb-6">
          <div class="flex items-center">
            <div class="bg-white/20 p-3 text-white rounded-lg mr-4">
              <lucide-icon name="listTodo" [size]="40" [strokeWidth]="1.5"></lucide-icon>
            </div>
            <div>
              <h2 class="text-2xl font-bold text-white">{{'Permisos del Sistema' | translate}}</h2>
              <p class="text-sky-200 mt-1">{{'Los permisos establecen las funciones de un usuario dentro de la aplicación' | translate}}</p>
            </div>
          </div>
          <div class="h-1 w-20 bg-sky-400 rounded-full mt-3"></div>
        </div>

        <!-- Mensaje sin permisos -->
        <div class="text-center my-8 p-6 bg-white rounded-xl shadow" *ngIf="permissions.length == 0">
          <p class="text-sm text-gray-500">{{'Presione Añadir para crear registros en esta sección' | translate}}</p>
        </div>

        <div *ngIf="permissions.length > 0">
          <!-- Filtro de búsqueda -->
          <!-- <div class="flex justify-center my-6">
            <div class="w-full max-w-md text-center">
              <div class="relative">
                <input class="w-full px-10 py-3 border border-gray-300 rounded-lg shadow-sm text-sm focus:ring-2 focus:ring-sky-500 focus:border-sky-500" 
                  #myInput type="text" placeholder="{{'Buscar..' | translate}}" (input)="initializeSearchFilter()">
                <div class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                  <i class="fas fa-search"></i>
                </div>
              </div>
              <p class="text-xs text-gray-500 mt-2">{{'Para utilizar correctamente el buscador por favor desplegar todos los registros con el paginador' | translate}}</p>
            </div>
          </div> -->

          <!-- Controles superiores -->
          <div class="flex flex-wrap justify-between items-center mb-6 gap-3 bg-white p-4 rounded-xl shadow">
            <!-- Información de paginación -->
            <div class="text-sm text-gray-600">
              <button type="button" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded text-sm mr-2 action-button" (click)="setPageSizeToTotal()">
                {{'Mostrar todo' | translate}}
              </button>
              {{pageIndex * pageSize + 1}} - {{(pageIndex + 1) * pageSize}} {{'de' | translate}} {{permissions.length}} {{'registros' | translate}}
            </div>

            <!-- Botones de acción -->
            <div class="flex flex-wrap gap-2">
              <button (click)="toRoles()" class="px-4 py-2 bg-sky-800 hover:bg-sky-900 text-white text-sm rounded-lg shadow flex items-center gap-1 action-button">
                <i class="fas fa-user-tag"></i> {{'Roles' | translate}}
              </button>
            </div>
          </div>

          <!-- Loading -->
          <div class="flex justify-center my-4" *ngIf="isLoading">
            <div class="flex space-x-2">
              <div class="w-4 h-4 rounded-full bg-gray-400 animate-ping"></div>
              <div class="w-4 h-4 rounded-full bg-gray-300 animate-ping"></div>
            </div>
          </div>

          <!-- Tabla de permisos -->
          <div class="overflow-x-auto bg-white rounded-2xl shadow-lg">
            <table class="min-w-full">
              <thead class="bg-gradient-to-r from-sky-800 to-sky-900 text-white">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider cursor-pointer" (click)="sortData('name')">
                    <div class="flex items-center">
                      {{'Nombre' | translate}}
                      <i class="fas fa-sort ml-1 text-xs"></i>
                    </div>
                  </th>
                  <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider cursor-pointer" (click)="sortData('accessCode')">
                    <div class="flex items-center">
                      {{'Código' | translate}}
                      <i class="fas fa-sort ml-1 text-xs"></i>
                    </div>
                  </th>
                  <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider cursor-pointer" (click)="sortData('state')">
                    <div class="flex items-center">
                      {{'Estado' | translate}}
                      <i class="fas fa-sort ml-1 text-xs"></i>
                    </div>
                  </th>
                  <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider cursor-pointer" (click)="sortData('description')">
                    <div class="flex items-center">
                      {{'Descripción' | translate}}
                      <i class="fas fa-sort ml-1 text-xs"></i>
                    </div>
                  </th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-200">
                <tr *ngFor="let permission of permissions.slice(pageIndex * pageSize, (pageIndex + 1) * pageSize)" class="hover:bg-gray-50">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div class="bg-sky-100 p-3 rounded-lg">
                        <i class="fas fa-key text-sky-600"></i>
                      </div>
                      <div class="ml-4">
                        <div class="text-sm font-medium text-gray-900">{{ permission.name | translate }}</div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900 font-mono">{{ permission.accessCode | translate }}</div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <span [ngClass]="{
                        'status-indicator active-status': permission.state === 'ACTIVO',
                        'status-indicator inactive-status': permission.state === 'INACTIVO'
                      }"></span>
                      <span class="text-sm text-gray-900">{{ permission.state | translate }}</span>
                    </div>
                  </td>
                  <td class="px-6 py-4">
                    <div class="text-sm text-gray-700 italic">"{{permission.description | translate}}"</div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- Paginador -->
          <!-- <div class="bg-white rounded-xl p-4 mt-4 shadow">
            <mat-paginator [length]="permissions.length" [pageSizeOptions]="[25, 50, 100, permissions.length]" showFirstLastButtons></mat-paginator>
          </div> -->
        </div>
      </div>
    </div>
  </div>
</body>
